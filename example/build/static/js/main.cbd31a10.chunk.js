(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(e,t,n){e.exports=n(28)},28:function(e,t,n){"use strict";n.r(t);for(var r=n(0),a=n.n(r),o=n(14),c=n.n(o),u=n(10),i=n(30),s=n(31),l=n(16),f=n(32),p=n(33),d=n(5),h=n.n(d),v=n(6),y=n(8),g=n(9),b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",m=new Uint8Array(256),w=0;w<b.length;w++)m[b.charCodeAt(w)]=w;var x=function(){function e(){Object(y.a)(this,e)}return Object(g.a)(e,null,[{key:"encode",value:function(e){var t,n=new Uint8Array(e),r=n.length,a="";for(t=0;t<r;t+=3)a+=b[n[t]>>2],a+=b[(3&n[t])<<4|n[t+1]>>4],a+=b[(15&n[t+1])<<2|n[t+2]>>6],a+=b[63&n[t+2]];return r%3===2?a=a.substring(0,a.length-1):r%3===1&&(a=a.substring(0,a.length-2)),a}},{key:"decode",value:function(e){var t,n,r,a,o,c=.75*e.length,u=e.length,i=0,s=new Uint8Array(c);for(t=0;t<u;t+=4)n=m[e.charCodeAt(t)],r=m[e.charCodeAt(t+1)],a=m[e.charCodeAt(t+2)],o=m[e.charCodeAt(t+3)],s[i++]=n<<2|r>>4,s[i++]=(15&r)<<4|a>>2,s[i++]=(3&a)<<6|63&o;return s.buffer}}]),e}();window.base64url=x;var E=x,k=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(y.a)(this,e);Object.assign(this,{pathPrefix:"/webauthn"},t)}return Object(g.a)(e,[{key:"getMakeCredentialsChallenge",value:function(){var e=Object(v.a)(h.a.mark(function e(t){var n,r;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this.pathPrefix,"/register"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:if(403!==(n=e.sent).status){e.next=9;break}return e.next=6,n.json();case 6:throw r=e.sent.message,"Registration failed",new Error(r?"".concat("Registration failed",": ").concat(r,"."):"".concat("Registration failed","."));case 9:if(!(n.status<200||n.status>205)){e.next=11;break}throw new Error("Server responded with error.");case 11:return e.next=13,n.json();case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"sendWebAuthnResponse",value:function(){var e=Object(v.a)(h.a.mark(function e(t){var n;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this.pathPrefix,"/response"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:if(200===(n=e.sent).status){e.next=5;break}throw new Error("Server responded with error.");case 5:return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getGetAssertionChallenge",value:function(){var e=Object(v.a)(h.a.mark(function e(t){var n;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this.pathPrefix,"/login"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:if(200===(n=e.sent).status){e.next=5;break}throw new Error("Server responded with error.");case 5:return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"register",value:function(){var t=Object(v.a)(h.a.mark(function t(){var n,r,a,o,c,u=arguments;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=u.length>0&&void 0!==u[0]?u[0]:{},t.prev=1,t.next=4,this.getMakeCredentialsChallenge(n);case 4:return r=t.sent,a=e.preformatMakeCredReq(r),t.next=8,navigator.credentials.create({publicKey:a});case 8:return o=t.sent,console.log("CREDENTIAL",o),c=e.publicKeyCredentialToJSON(o),t.next=13,this.sendWebAuthnResponse(c);case 13:return t.abrupt("return",t.sent);case 16:t.prev=16,t.t0=t.catch(1),console.error(t.t0);case 19:case"end":return t.stop()}},t,this,[[1,16]])}));return function(){return t.apply(this,arguments)}}()},{key:"login",value:function(){var t=Object(v.a)(h.a.mark(function t(){var n,r,a,o,c,u=arguments;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=u.length>0&&void 0!==u[0]?u[0]:{},t.prev=1,t.next=4,this.getGetAssertionChallenge(n);case 4:return r=t.sent,a=e.preformatGetAssertReq(r),t.next=8,navigator.credentials.get({publicKey:a});case 8:return o=t.sent,console.log("CREDENTIAL",o),c=e.publicKeyCredentialToJSON(o),t.next=13,this.sendWebAuthnResponse(c);case 13:return t.abrupt("return",t.sent);case 16:t.prev=16,t.t0=t.catch(1),console.error(t.t0);case 19:case"end":return t.stop()}},t,this,[[1,16]])}));return function(){return t.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(v.a)(h.a.mark(function e(){var t;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this.pathPrefix,"/logout"),{method:"GET",credentials:"include"});case 2:if(200===(t=e.sent).status){e.next=5;break}throw new Error("Server responded with error.");case 5:return e.next=7,t.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}],[{key:"publicKeyCredentialToJSON",value:function(t){if(t instanceof Array){var n=[],r=!0,a=!1,o=void 0;try{for(var c,u=t[Symbol.iterator]();!(r=(c=u.next()).done);r=!0){var i=c.value;n.push(e.publicKeyCredentialToJSON(i))}}catch(f){a=!0,o=f}finally{try{r||null==u.return||u.return()}finally{if(a)throw o}}return n}if(t instanceof ArrayBuffer)return E.encode(t);if(t instanceof Object){var s={};for(var l in t)s[l]=e.publicKeyCredentialToJSON(t[l]);return s}return t}},{key:"generateRandomBuffer",value:function(e){var t=new Uint8Array(e||32);return window.crypto.getRandomValues(t),t}},{key:"preformatMakeCredReq",value:function(e){return e.challenge=E.decode(e.challenge),e.user.id=E.decode(e.user.id),e}},{key:"preformatGetAssertReq",value:function(e){e.challenge=E.decode(e.challenge);var t=!0,n=!1,r=void 0;try{for(var a,o=e.allowCredentials[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var c=a.value;c.id=E.decode(c.id)}}catch(u){n=!0,r=u}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return e}}]),e}();var C=function(){var e=Object(r.useState)(""),t=Object(u.a)(e,2),n=t[0],o=t[1],c=Object(r.useState)(""),d=Object(u.a)(c,2),h=d[0],v=d[1],y=Object(r.useState)(new k),g=Object(u.a)(y,1)[0];return a.a.createElement(i.a,null,a.a.createElement(s.a,{style:{paddingTop:80}},a.a.createElement(l.a,null,a.a.createElement("h3",null,"Register"),a.a.createElement(f.a,null,a.a.createElement(f.a.Group,null,a.a.createElement(f.a.Label,null,"Username"),a.a.createElement(f.a.Control,{type:"text",value:h,onChange:function(e){return v(e.target.value)}})),a.a.createElement(f.a.Group,null,a.a.createElement(f.a.Label,null,"Name"),a.a.createElement(f.a.Control,{type:"text",value:n,onChange:function(e){return o(e.target.value)}}),a.a.createElement(f.a.Text,{className:"text-muted"},"This name will be displayed publicly.")),a.a.createElement(p.a,{variant:"primary",onClick:function(){g.register({name:n,username:h})}},"Register"))),a.a.createElement(l.a,null,a.a.createElement("h3",null,"Login"),a.a.createElement(f.a,null,a.a.createElement(f.a.Group,null,a.a.createElement(f.a.Label,null,"Username"),a.a.createElement(f.a.Control,{type:"text",value:h,onChange:function(e){return v(e.target.value)}})),a.a.createElement(p.a,{variant:"primary",onClick:function(){g.login({username:h})}},"Login")))),a.a.createElement(s.a,{style:{paddingTop:80}},a.a.createElement(l.a,null,a.a.createElement(p.a,{variant:"outline-primary",block:!0,onClick:function(){g.logout()}},"Logout"))))};n(27);c.a.render(a.a.createElement(C,null),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.cbd31a10.chunk.js.map